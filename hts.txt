1. Initial folder setup/structure and requirements.txt setup
2. Create a server/main file w/ middleware configs
3. Spin up docker container by creating a dockerfile
4. docker-compose.yml setup
5. bootstrap the app by bulding docker compose
6. fastapi router flow

==================================
==================================
==================================
==================================
initial setup should look like this

|-- backend
|   |-- app
|       |-- api
|       |-- core
|       |-- db
|       |-- emails
|       |-- models
|       |-- services
|       |-- utils
|   |-- tests
|       |-- conftest.py
|   |-- .env
|   |-- Dockerfile
|   |-- requirements.txt
|-- .flake8
|-- .gitignore
|-- docker-compose.yml
|-- README.md
 
requirements.txt
# app
fastapi==0.55.1
uvicorn==0.11.3
pydantic==1.4
email-validator==1.1.1

=================================
# create a server

touch backend/app/api/__init__.py backend/app/api/server.py

from fastapi import FastAPI
from starlette.middleware.cors import CORSMiddleware
 
 
def get_application():
    app = FastAPI(title="Phresh", version="1.0.0")
 
    app.add_middleware(
        CORSMiddleware,
        allow_origins=["*"],
        allow_credentials=True,
        allow_methods=["*"],
        allow_headers=["*"],
    )
 
    return app
 
 
app = get_application()
 
 
================================
Spin up docker container
@Dockerfile
FROM python:3.13-slim-bookworm

WORKDIR /backend

# Avoid making .pyc files to reduce clutter in the container
ENV PYTHONDONTWRITEBYTECODE 1
# Unbuffered output, so logs appear immediately
ENV PYTHONBUFFERED 1

# install system dependencies
# updates the package index
RUN apt-get update \
    && apt-get -y install netcat-openbsd gcc postgresql \
    && apt-get clean \
    && rm -rf /var/lib/apt/lists/*

# install python dependencies
RUN pip install --upgrade pip
# copy requirements from local to container
COPY ./requirements.txt /backend/requirements.txt
RUN pip install --no-cache-dir -r requirements.txt

# copy the local "backend" folder into the container
COPY . /backend

================================
docker-compose.yml
services: # Section to define container/servic in the project 
  server: # name of the service
    build: # tells docker to build an image from a Dockerfile
      context: . # Set the build context (The folder docker will use for copying files)
      dockerfile: backend/Dockerfile # Specifies which Dockerfile to use
    volumes:
      - ./backend:/backend # Mounts the local "./backend" folder to /backend/ inside the container. this will make local changes immediately reflected in the container
    command: ["uvicorn", "app.api.server:app", "--reload", "--workers", "1", "--host", "0.0.0.0", "--port", "8000"] 
    env_file:
      - ./backend/.env # Loads environment variables from .env files e.g., DATABASE_URL, SECRET_KEY, etc. w/o hardcoding into Docker
    ports:
      - "8000:8000" # Maps container port 8000 to host port 8000. Allow to access app in local browser
================================
Bootstrapping the app
docker-compose up -d --build 
docker-compose up
================================
fastapi router flow
1. server.py
    - create the fastapi app, include the top-level router with a main prefix:
    app.include_router(api_router, prefix="/api")
2. app/__init__.py
    - aggregate all routes modules using APIRouter()
    - assign module prefixes
    router.include_router(cves_router, prefix="/cves")
    router.include_router(users_router, prefix="/users")
3. route files
    - define the actual endopints with APIRouter()
4. URL Composition
    - /<server prefix>/<module prefix>/<endpoint path>

 
